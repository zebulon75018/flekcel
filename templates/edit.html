<!DOCTYPE html>
<html lang="en" >

<head>
  <meta charset="UTF-8">
  <title>Flekel Edit {{file}}</title>
  
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
  <link rel='stylesheet' href='https://handsontable.com/dist/handsontable.full.css'>  
</head>

<body>

  <h1>{{file}}</b></h1>

   
<div id="grid" class="handsontable"></div>

<button id="save">Save</button>
<script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
<script src='https://handsontable.com/dist/handsontable.full.js'></script>

<script>
        $(function () {

var data = {{data|tojson}};

var container = document.getElementById('grid'),
hot = new Handsontable(container, {
  data: data,
  minSpareRows: 1,
  colHeaders: true,
  contextMenu: true
});

$("#save").click( function() {
$.ajax('/save/{{file}}', 'GET', JSON.stringify({data: hot.getData()}), function (res) {
    var response = JSON.parse(res.response);

    if (response.result === 'ok') {
      exampleConsole.innerText = 'Data saved';
    }
    else {
      exampleConsole.innerText = 'Save error';
    }
  });
});

});
    </script>
</body>

</html>
