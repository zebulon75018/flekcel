<!DOCTYPE html>
<html lang="en" >

<head>
  <meta charset="UTF-8">
  <title>Excel-Like example with Handsontable</title>
  
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">

  <link rel='stylesheet' href='https://handsontable.com/dist/handsontable.full.css'>

      <link rel="stylesheet" href="css/style.css">

  
</head>

<body>

  <h1>{{file}}</b></h1>

   
<div id="grid" class="handsontable"></div>
<script src='http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
<script src='https://handsontable.com/dist/handsontable.full.js'></script>

<script>
        $(function () {

var data = {{data|tojson}};

var container = document.getElementById('grid'),
hot = new Handsontable(container, {
  data: data,
  minSpareRows: 1,
  colHeaders: true,
  contextMenu: true
});

(function bindDumpButton() {

    Handsontable.Dom.addEvent(document.body, 'click', function (e) {

      var element = e.target || e.srcElement;

      if (element.nodeName == 'BUTTON' && element.name == 'dump') {
        var name = element.getAttribute('data-dump');
        var instance = element.getAttribute('data-instance');
        var hot = window[instance];
      }
   });
 })();

});
    </script>
</body>

</html>
